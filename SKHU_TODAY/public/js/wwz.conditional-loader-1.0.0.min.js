/**
 * 브라우저에 따라 스크립트 로딩 처리(ie11 용)
 */
function ConditionalLoader () {
	var methods = {
		loadCss : function (_css, _callback) {
			var ua = window.navigator.userAgent,
				ie11 = false, 
				link, url;

			if(ua.indexOf('Trident/') > -1) {
				ie11 = true;
			}

			link = document.createElement('link');
			link.rel="stylesheet";
			link.type= 'text/css';
	    	link.charset = "utf-8";

			if(ie11){
				url = _css.replace('.gz', '');
			} else {
				url = _css;
			}

			this.processLoad('css', url, link, _callback);
		},
		loadJs : function (_js, _callback) {
			var ua = window.navigator.userAgent,
				ie11 = false,
				script, url;

			if(ua.indexOf('Trident/') > -1) {
				ie11 = true;
			}

			script= document.createElement('script');
		    script.type= 'text/javascript';
		    script.charset = "utf-8";

		    if(ie11){
				url = _js.replace('.gz', '');
			} else {
				url = _js;
			}

			this.processLoad('js', url, script, _callback);
		},
		loadRequired : function (_orginRequired, _script, _callback) {
			var ua = window.navigator.userAgent,
				ie11 = false,
				required, url;

			if(ua.indexOf('Trident/') > -1) {
				ie11 = true;
			}

			required= document.createElement('script');
		    required.type= 'text/javascript';
		    required.charset = "utf-8";

		     if(ie11){
		     	_script = _script.replace('.js', '');
				url = _script + "-ie.js";
			} else {
				url = _script;
			}

			this.processLoad('require', url, required, _callback, _orginRequired);
		},
		processLoad : function (_type, _url, _elem, _callback, _orginRequired) {
			var loaded = false,
				head= document.getElementsByTagName('head')[0];

			_elem.onreadystatechange= function () {
		        if (this.readyState == 'loaded' || this.readyState == 'complete') {
		            if (loaded) {
		                return;
		            }
		            loaded = true;

		            if(_callback){
		            	_callback();
		            }
		        }
		    }

		    _elem.onload = function () {
		    	if(_callback){
		    		_callback();
		    	}
		    }

		    if(_type === "css"){
		    	_elem.href = _url;
		    } else if(_type === "js"){
		    	_elem.src = _url;
		    } else if(_type === 'require'){
		    	_elem.src = _orginRequired;
		    	_elem.setAttribute('data-main', _url);
		    }
		    
		    head.appendChild(_elem);
		}
	};

	return methods;
};